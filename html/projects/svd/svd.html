        <!-- ----------------------------------------------------------------------------------------------------------------- -->
         <div id="modal-svd" class="popup-modal mfp-hide">
		      <div class="description-box">
			      <h3>Singular Value Decomposition (SVD) of Monte Carlo variance reduction parameters</h3>
                  <a href="https://doi.org/10.1016/j.anucene.2020.107327"> 2020 journal article</a>    <br><br>

<h4>SVD basics</h4>

<p>
Singular Value Decomposition (SVD) is a matrix factorization method that has
applications in data compression and categorization problems.  For an $m \times
n$ matrix $\mathbf{A}$ the SVD is

$$
\mathbf{A}_{m \times n} 
= \mathbf{U}_{m \times m} \mathbf{\Sigma}_{m \times n} \mathbf{V}_{n \times n}^T,
$$

where $\Sigma$ is a diagonal matrix. In this diagonal matrix, the entries
decrease monotonically. As a result, an estimate of $A$ can be formed by
truncating the $\mathbf{U}$, $\mathbf{\Sigma}$, and $\mathbf{V}$ matrices.
Specifically, an estimate of the $a_{ij}$ entry in the $\mathbf{A}$ matrix is

$$
a_{ij} \approx \sum_{k=1}^K u_{ik} \sigma_{kk} v_{jk}.
$$

In other words, an estimate of the $\mathbf{A}$ matrix &mdash; referred to as a
bill "reconstruction" &mdash; can be obtained by storing only the first $K$
rows in $\mathbf{U}$, the first $K$ entries along the diagonal of
$\mathbf{\Sigma}$, and the first $K$ columns in $\mathbf{V}$, which results in
a factor of $M$ memory savings, where $M$ is given by

$$
M = \frac{\text{memory with full rank}}{\text{memory with rank $k$}} 
  = \frac{mn}{mk + k + nk}.
$$

For example, consider the following $1,333 \times 1,000$ pixel image of an cave
waterfall in Jackson County, AL:

<img  src="html/projects/svd/files/rank_full.png" alt="" height="30%" width="30%" class="center" style="padding:20px;"/>

This image can be represented by a $1,333 \times 1000$ matrix with entries
representing the color of each pixel (gray-scale values between 0 and 1).
Three reconstructions of this image are shown below.

<img  src="html/projects/svd/files/three_ks.png" alt="" height="80%" width="80%" class="center" style="padding:20px;" />

The $K=100$ reconstruction provides a fairly accurate representation of the
image and requires $M=5.71$ times less memory. This technique has previously
been for a variety of scientific applicaitons including bioinformativs, signal
processing, and nuclear reactor noise analysis.
</p>

<h4>Radiation transport application</h4>
<p>

Monte Carlo (MC) radiation transport calculations are used to assess the safety
and performance of nuclear reactors and other nuclear systems. This methods
uses a random walk technique to simulate the paths particles (i.e., neutrons or
photons), take as they move through a nuclear system. By simulating enough of
these particle paths, statistical methods can be used to surmise the aggragate
behavior of the system, such as the particle flux distribution throughout a
region of interest.

In order to accelerate the convergence of the solution, most MC codes employ a
class of biased random sampling techniques known as MC variance reduction (VR).
These methods require a low-order estimate of the adjoint flux distribution,
which describes the "importance" of position/energy phase space regions to the
final result.  This information is supplied via "importance maps": 3D spatial
meshes with each mesh volume element tagged with an energy-wise adjoint fluxes.
These important maps require a significant amount of RAM, which can limit the
fidelity of the simulation that can be achieved.

SVD can be used to compress importance maps for reduced memory requirements. In
the example above, the $\mathbf{A}$ matrix represents the two spatial
dimensions of the waterfall image.  In this work, the 3 spatial dimensions of
the importance maps are collapsed such that the 2 dimensions of the
$\mathbf{A}$ matrix represent space and energy. This allows an $A$ matrix to be
formulated as:

$$   \mathbf{A}  =
  \begin{bmatrix}
    \phi^{\dagger \, g = 0}_{c = 0} &  \phi^{\dagger \, g = 1}_{c = 0} & \dots &  \phi^{\dagger \, g = N_g - 1}_{c = 0} \\[0.3cm]
    \phi^{\dagger \, g = 0}_{c = 1} &  \phi^{\dagger \, g = 1}_{c = 1} & \dots &  \phi^{\dagger \, g = N_g - 1}_{c = 1} \\[0.3cm]
    \vdots & \vdots & \ddots & \vdots \\[0.3cm]
    \phi^{\dagger \, g = 0}_{c = N_{c} - 1} &  \phi^{\dagger \, g = 1}_{c = N_{c} - 1} & \dots &  \phi^{\dagger \, g = N_g - 1}_{c = N_{c} - 1} \\[0.3cm]
  \end{bmatrix},
$$

where $\phi^{\dagger}$ denotes the adjoint flux, $g$ denotes the energy group
index, and $c$ denotes the spatial index. Since adjoint flux distributions may
vary by ten orders of magnitude or more, and SVD in log-space was also considered, i.e.,

$$
   \mathbf{A}  =
  \begin{bmatrix}
    \log\left(\phi^{\dagger \, g = 0}_{c = 0}\right) &  \log\left(\phi^{\dagger \, g = 1}_{c = 0}\right) & \dots &  \log\left(\phi^{\dagger \, g = N_g - 1}_{c = 0}\right) \\[0.3cm]
    \log\left(\phi^{\dagger \, g = 0}_{c = 1}\right) & \log\left(\phi^{\dagger \, g = 1}_{c = 1}\right) & \dots &  \log\left(\phi^{\dagger \, g = N_g - 1}_{c = 1}\right) \\[0.3cm]
    \vdots & \vdots & \ddots & \vdots \\[0.3cm]
    \log\left(\phi^{\dagger \, g = 0}_{c = N_{c} - 1}\right) & \log\left(\phi^{\dagger \, g = 1}_{c = N_{c} - 1}\right) & \dots & \log\left(\phi^{\dagger \, g = N_g - 1}_{c = N_{c} - 1}\right) \\[0.3cm]
  \end{bmatrix}.
$$

Both formulations were implemented and performance tested in the 
<a href="https://doi.org/10.1016/j.jcp.2015.12.037">Shift</a> Monte Carlo
radiation transport code.

<h4>Westinghouse AP1000 Pressurized Water Reator</h4>
<p>

The AP1000 is a Generation III+ nuclear reactor currently being constructed in
the US and China. SVD compression of importance maps was tested for the excore dosimetry problem shown below.

        <img src="html/projects/svd/files/ap1000_geom_source.png" alt="" height="75%" width="75%" class="center" style="padding:20px" />



This problem consists of a quarter-core model (with reflecting boundaries). The image shows a midplan $Z$-slice

<img  src="html/projects/svd/files/ap1000_adj_flux.png" alt="" height="50%" width="50%" class="center" style="padding:20px;" />
<img  src="html/projects/svd/files/ap1000_speedup.png" alt="" height="50%" width="50%" class="center" style="padding:20px;" />

<h4>Joint European Torus (JET) Fusion Reactor</h4>
<p>

<img src="html/projects/svd/files/jet_geom_source.png" alt="" height="50%" width="75%" class="center" style="padding:20px;" />
<img  src="html/projects/svd/files/jet_adj_flux.png" alt="" height="50%" width="50%" class="center" style="padding:20px;" />
<img  src="html/projects/svd/files/jet_speedup.png" alt="" height="50%" width="50%" class="center" style="padding:20px;" />



                  <p/>
		      </div>
            <div class="link-box">
		         <a class="popup-modal-dismiss">Close</a>
            </div>
	      </div><!-- modal-svd End -->
          <!-- ----------------------------------------------------------------------------------------------------------------- -->
